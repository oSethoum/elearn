var G=Object.defineProperty,L=Object.defineProperties;var H=Object.getOwnPropertyDescriptors;var N=Object.getOwnPropertySymbols;var O=Object.prototype.hasOwnProperty,Q=Object.prototype.propertyIsEnumerable;var k=(c,s,e)=>s in c?G(c,s,{enumerable:!0,configurable:!0,writable:!0,value:e}):c[s]=e,u=(c,s)=>{for(var e in s||(s={}))O.call(s,e)&&k(c,e,s[e]);if(N)for(var e of N(s))Q.call(s,e)&&k(c,e,s[e]);return c},q=(c,s)=>L(c,H(s));import{u as w,a as D,b as U,n as E,c as W,d as F,e as J}from"./schema.bcb88cc1.js";import{t as S,r as b,v as p,w as j,z as T,j as r,B as P,d as m,S as z,x as A,y as f,D as B,h as M,E as I,J as K,K as R,O as v,Q as X,U as Y}from"./vendor.0be45842.js";import{u as V,L as Z}from"./index.388e8e0a.js";import{D as _}from"./DataGrid.9dd6d65b.js";const $=({onCancel:c,onSubmit:s,course:e})=>{var h,o;const{t:a}=S(),{data:n}=w(),{data:l}=D(),[y]=U(),g=b.exports.useMemo(()=>p.object({title:p.string().nonempty(a("notEmpty")),description:p.string(),topic:p.string().nonempty(a("notEmpty")),year:p.string().nonempty(a("notEmpty")),teacher:p.string().nonempty()}),[]),i=j({schema:T(g),initialValues:{title:e.title,description:e.description||"",topic:(h=e.topicId)==null?void 0:h.toString(),teacher:"1",year:e.year.toString()}}),C=t=>{const d=[];if(t)for(let x=1;x<=t;x++)d.push(x.toString());return d};return r(P,{children:m("form",{onSubmit:i.onSubmit(t=>{y({variables:{where:{id:e.id},data:{title:{set:t.title},description:{set:t.description},topic:{connect:{id:parseInt(t.topic)}},teacher:{connect:{id:parseInt(t.teacher)}},year:{set:parseInt(t.year)}}},refetchQueries:[E.Query.Courses],onCompleted(){s==null||s()}})}),noValidate:!0,children:[m(z,{cols:1,breakpoints:[{minWidth:"md",cols:2}],mb:10,children:[r(A,u({label:a("title"),placeholder:a("title")},i.getInputProps("title"))),r(f,u({label:a("teacher"),required:!0,data:(l==null?void 0:l.teachers.map(t=>({label:t.firstName+" "+t.lastName,value:t.id.toString()})))||[]},i.getInputProps("teacher"))),r(f,u({label:a("topic"),required:!0,data:(n==null?void 0:n.topics.map(t=>{var d;return{label:t.name,value:t.id.toString(),group:(d=t.department)==null?void 0:d.name}}))||[]},i.getInputProps("topic"))),r(f,u({label:a("year"),required:!0,data:C((o=n==null?void 0:n.topics.find(t=>t.id===parseInt(i.values.topic)))==null?void 0:o.years)||[]},i.getInputProps("year")))]}),r(B,u({label:a("description"),placeholder:a("description")},i.getInputProps("description"))),m(M,{mt:20,position:"right",children:[r(I,{variant:"default",onClick:c,children:a("cancel")}),r(I,{color:"green",type:"submit",children:a("apply")})]})]})})},ee=({onCancel:c,onSubmit:s})=>{var h;const{t:e}=S(),{data:a}=w(),{data:n}=D(),[l]=W(),{setHeader:y}=V();b.exports.useEffect(()=>{y("courses")},[]);const g=b.exports.useMemo(()=>p.object({title:p.string().nonempty(e("notEmpty")),description:p.string().nonempty(e("notEmpty")),topic:p.string().nonempty(e("notEmpty")),year:p.string().nonempty(e("notEmpty")),teacher:p.string().nonempty(e("notEmpty"))}),[]),i=j({schema:T(g),initialValues:{title:"",description:"",topic:"1",year:"1",teacher:"1"}}),C=o=>{const t=[];if(o)for(let d=1;d<=o;d++)t.push(d.toString());return t};return r(P,{children:m("form",{onSubmit:i.onSubmit(o=>{console.log(o),l({variables:{data:{title:o.title,description:o.description,topic:{connect:{id:parseInt(o.topic)}},teacher:{connect:{id:parseInt(o.teacher)}},year:parseInt(o.year)}},refetchQueries:[E.Query.Courses],onCompleted(){s==null||s()}})}),noValidate:!0,children:[m(z,{cols:1,breakpoints:[{minWidth:"md",cols:2}],mb:10,children:[r(A,q(u({label:e("title"),placeholder:e("title")},i.getInputProps("title")),{required:!0})),r(f,u({required:!0,label:e("teacher"),data:(n==null?void 0:n.teachers.map(o=>({label:o.firstName+" "+o.lastName,value:o.id.toString()})))||[]},i.getInputProps("teacher"))),r(f,u({required:!0,label:e("topic"),data:(a==null?void 0:a.topics.map(o=>{var t;return{label:o.name,value:o.id.toString(),group:(t=o.department)==null?void 0:t.name}}))||[]},i.getInputProps("topic"))),r(f,u({label:e("year"),required:!0,data:C((h=a==null?void 0:a.topics.find(o=>o.id===parseInt(i.values.topic)))==null?void 0:h.years)||[]},i.getInputProps("year")))]}),r(B,u({label:e("description"),placeholder:e("description")},i.getInputProps("description"))),m(M,{mt:20,position:"right",children:[r(I,{variant:"default",onClick:c,children:e("cancel")}),r(I,{type:"submit",color:"blue",children:e("add")})]})]})})},ae=()=>{const[c,s]=b.exports.useState([]),{data:e,loading:a}=F(),{t:n}=S(),l=K(),[y]=J(),g=R(),{setHeader:i}=V();if(b.exports.useEffect(()=>{i("courses")},[]),a)return r(Z,{height:"80vh"});const C=t=>l.openConfirmModal({title:n("delete"),children:n("deleteMessage"),labels:{confirm:n("confirm"),cancel:n("cancel")},withCloseButton:!1,confirmProps:{color:"red"},centered:!0,onCancel:()=>{},onConfirm:()=>{y({variables:{where:{id:e==null?void 0:e.courses[t].id}},refetchQueries:[E.Query.Courses]})}}),h=t=>{const d=l.openModal({title:n("editCourse"),size:"xl",children:r($,{course:e==null?void 0:e.courses[t],onCancel:()=>l.closeModal(d),onSubmit:()=>{l.closeModal(d),g.showNotification({message:n("success"),color:"green"})}})})};return m(P,{sx:{height:"100%"},children:[r(M,{mt:5,my:15,children:r(I,{onClick:()=>{const t=l.openModal({title:n("addCourse"),size:"xl",children:r(ee,{onCancel:()=>{l.closeModal(t)},onSubmit:()=>{l.closeModal(t),g.showNotification({message:n("success"),color:"green"})}})})},children:n("add")})}),r(_,{headerModifier:n,selectedIndexes:c,setSelectedIndexes:s,data:e==null?void 0:e.courses.map(t=>({id:t.id,title:t.title,teacher:t.teacher?t.teacher.firstName+" "+t.teacher.lastName:"no author"})),actionsLabel:n("actions"),actions:t=>m(M,{children:[r(v,{onClick:()=>h(t),color:"green",variant:"light",children:r(X,{})}),r(v,{onClick:()=>C(t),color:"red",variant:"light",children:r(Y,{})})]})})]})};export{ae as DashboardCourses,ae as default};
