var K=Object.defineProperty,R=Object.defineProperties;var _=Object.getOwnPropertyDescriptors;var z=Object.getOwnPropertySymbols;var X=Object.prototype.hasOwnProperty,Y=Object.prototype.propertyIsEnumerable;var V=(t,s,e)=>s in t?K(t,s,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[s]=e,c=(t,s)=>{for(var e in s||(s={}))X.call(s,e)&&V(t,e,s[e]);if(z)for(var e of z(s))Y.call(s,e)&&V(t,e,s[e]);return t},f=(t,s)=>R(t,_(s));import{u as Z,L as $}from"./index.388e8e0a.js";import{y as ee,u as W,n as M,z as se,A as re,B as te,C as ae,D as oe,E as ne}from"./schema.bcb88cc1.js";import{t as k,r as I,v as i,w as D,z as Q,j as r,B as E,d as p,S as U,x as u,F as ie,y as q,h as C,E as N,P as j,J as le,K as ce,au as me,az as x,ax as v,O as B,Q as A,a_ as S}from"./vendor.0be45842.js";import{D as L}from"./DataGrid.9dd6d65b.js";const de=({onSubmit:t,onCancel:s,student:e})=>{var l,g;const{t:n}=k(),[b]=ee(),{data:d}=W(),o=I.exports.useMemo(()=>i.object({firstName:i.string().nonempty(n("notEmpty")),lastName:i.string().nonempty(n("notEmpty")),email:i.string().email(n("invalidEmail")),username:i.string().nonempty(n("notEmpty")),year:i.string().nonempty(n("notEmpty")),topic:i.string().nonempty(n("notEmpty"))}),[]),h=D({schema:Q(o),initialValues:{firstName:e.firstName,lastName:e.lastName,username:e.user.username,email:e.user.email,year:e.year.toString(),topic:(l=e.topicId)==null?void 0:l.toString()}}),P=m=>{const w=[];if(m)for(let T=1;T<=m;T++)w.push(T.toString());return w};return r(E,{p:10,children:p("form",{onSubmit:h.onSubmit(m=>{b({variables:{where:{id:e.id},data:{firstName:{set:m.firstName},lastName:{set:m.lastName},year:{set:parseInt(m.year)},topic:{connect:{id:parseInt(m.topic)}},user:{update:{email:{set:m.email},username:{set:m.username}}}}},refetchQueries:[M.Query.DashboardUsers],onCompleted(){t&&t()}})}),noValidate:!0,children:[p(U,{my:10,cols:2,breakpoints:[{maxWidth:"md",cols:1}],children:[r(u,f(c({label:n("firstName"),placeholder:n("firstName")},h.getInputProps("firstName")),{required:!0})),r(u,f(c({label:n("lastName"),placeholder:n("lastName")},h.getInputProps("lastName")),{required:!0})),d&&p(ie,{children:[r(q,c({label:n("topic"),data:d==null?void 0:d.topics.map(m=>{var w;return{label:m.name,value:m.id.toString(),group:(w=m.department)==null?void 0:w.name}})},h.getInputProps("topic"))),r(q,c({label:n("year"),data:P((g=d==null?void 0:d.topics.find(m=>m.id===parseInt(h.values.topic)))==null?void 0:g.years)},h.getInputProps("year")))]}),r(u,f(c({label:n("username"),placeholder:n("username")},h.getInputProps("username")),{required:!0})),r(u,f(c({label:n("email"),placeholder:n("email")},h.getInputProps("email")),{required:!0}))]}),p(C,{position:"right",mt:20,children:[r(N,{variant:"default",onClick:s,children:n("cancel")}),r(N,{type:"submit",color:"green",children:n("apply")})]})]})})},pe=({onCancel:t,onSubmit:s,teacher:e})=>{const{t:n}=k(),[b]=se(),d=I.exports.useMemo(()=>i.object({firstName:i.string().nonempty(n("notEmpty")),lastName:i.string().nonempty(n("notEmpty")),email:i.string().email(n("invalidEmail")),username:i.string().nonempty(n("notEmpty"))}),[]),o=D({schema:Q(d),initialValues:{firstName:e.firstName,lastName:e.lastName,email:e.user.email,username:e.user.username}});return r(E,{children:p("form",{onSubmit:o.onSubmit(h=>{b({variables:{where:{id:e.id},data:{firstName:{set:h.firstName},lastName:{set:h.lastName},user:{update:{username:{set:h.username},email:{set:h.email}}}}},refetchQueries:[M.Query.DashboardUsers],onCompleted(){s&&s()}})}),noValidate:!0,children:[p(U,{cols:1,breakpoints:[{minWidth:"md",cols:2}],children:[r(u,c({label:n("firstName"),placeholder:n("firstName")},o.getInputProps("firstName"))),r(u,c({label:n("lastName"),placeholder:n("lastName")},o.getInputProps("lastName"))),r(u,c({label:n("username"),placeholder:n("username")},o.getInputProps("username"))),r(u,c({label:n("email"),placeholder:n("email")},o.getInputProps("email")))]}),p(C,{position:"right",mt:20,children:[r(N,{onClick:t,variant:"default",children:n("cancel")}),r(N,{type:"submit",color:"green",children:n("apply")})]})]})})},ue=({onSubmit:t,onCancel:s})=>{var P;const{t:e}=k(),[n]=re(),{data:b}=W(),d=I.exports.useMemo(()=>i.object({firstName:i.string().nonempty(e("notEmpty")),lastName:i.string().nonempty(e("notEmpty")),email:i.string().email(e("invalidEmail")),username:i.string().nonempty(e("notEmpty")),password:i.string().nonempty(e("notEmpty")),confirmPassword:i.string().nonempty(e("notEmpty")),year:i.string().nonempty(e("notEmpty")),topic:i.string().nonempty(e("notEmpty"))}).refine(l=>l.password===l.confirmPassword,{message:e("passwordsDontMatch"),path:["confirmPassword"]}),[]),o=D({schema:Q(d),initialValues:{firstName:"",lastName:"",username:"",password:"",confirmPassword:"",email:"",year:"1",topic:"1"}}),h=l=>{const g=[];if(l)for(let m=1;m<=l;m++)g.push(m.toString());return g};return r(E,{p:10,children:p("form",{onSubmit:o.onSubmit(l=>{n({variables:{data:{firstName:l.firstName,lastName:l.lastName,year:parseInt(l.year),topic:{connect:{id:parseInt(l.topic)}},user:{create:{disabled:!1,email:l.email,password:l.password,role:"student",username:l.username}}}},refetchQueries:[M.Query.DashboardUsers],onCompleted(){t&&t()}})}),noValidate:!0,children:[p(U,{my:10,cols:2,breakpoints:[{maxWidth:"md",cols:1}],children:[r(u,f(c({label:e("firstName"),placeholder:e("firstName")},o.getInputProps("firstName")),{required:!0})),r(u,f(c({label:e("lastName"),placeholder:e("lastName")},o.getInputProps("lastName")),{required:!0})),r(q,c({label:e("topic"),required:!0,data:(b==null?void 0:b.topics.map(l=>{var g;return{label:l.name,value:l.id.toString(),group:(g=l.department)==null?void 0:g.name}}))||[]},o.getInputProps("topic"))),r(q,c({label:e("year"),required:!0,data:h((P=b==null?void 0:b.topics.find(l=>l.id===parseInt(o.values.topic)))==null?void 0:P.years)||[]},o.getInputProps("year"))),r(u,f(c({label:e("username"),placeholder:e("username")},o.getInputProps("username")),{required:!0})),r(u,f(c({label:e("email"),placeholder:e("email")},o.getInputProps("email")),{required:!0})),r(j,f(c({label:e("password"),placeholder:e("password")},o.getInputProps("password")),{required:!0})),r(j,f(c({label:e("confirmPassword"),placeholder:e("confirmPassword")},o.getInputProps("confirmPassword")),{required:!0}))]}),p(C,{position:"right",children:[r(N,{variant:"default",onClick:s,children:e("cancel")}),r(N,{type:"submit",children:e("add")})]})]})})},he=({onCancel:t,onSubmit:s})=>{const{t:e}=k(),[n]=te(),b=I.exports.useMemo(()=>i.object({firstName:i.string().nonempty(e("notEmpty")),lastName:i.string().nonempty(e("notEmpty")),email:i.string().email(e("invalidEmail")),username:i.string().nonempty(e("notEmpty")),password:i.string().nonempty(e("notEmpty")),confirmPassword:i.string().nonempty(e("notEmpty"))}).refine(o=>o.password===o.confirmPassword,{message:e("passwordsDontMatch"),path:["confirmPassword"]}),[]),d=D({schema:Q(b),initialValues:{firstName:"",lastName:"",email:"",username:"",password:"",confirmPassword:""}});return r(E,{children:p("form",{onSubmit:d.onSubmit(o=>{n({variables:{data:{firstName:o.firstName,lastName:o.lastName,user:{create:{username:o.username,password:o.password,email:o.email,disabled:!1,role:"teacher"}}}},refetchQueries:[M.Query.DashboardUsers],onCompleted(){s&&s()}})}),noValidate:!0,children:[p(U,{cols:1,breakpoints:[{minWidth:"md",cols:2}],children:[r(u,f(c({label:e("firstName"),placeholder:e("firstName")},d.getInputProps("firstName")),{required:!0})),r(u,f(c({label:e("lastName"),placeholder:e("lastName")},d.getInputProps("lastName")),{required:!0})),r(u,f(c({label:e("email"),placeholder:e("email")},d.getInputProps("email")),{required:!0})),r(u,f(c({label:e("username"),placeholder:e("username")},d.getInputProps("username")),{required:!0})),r(u,f(c({label:e("password"),placeholder:e("password")},d.getInputProps("password")),{required:!0})),r(u,f(c({label:e("confirmPassword"),placeholder:e("confirmPassword")},d.getInputProps("confirmPassword")),{required:!0}))]}),p(C,{position:"right",mt:20,children:[r(N,{onClick:t,variant:"default",children:e("cancel")}),r(N,{type:"submit",children:e("add")})]})]})})},we=()=>{const{t}=k(),{data:s}=ae(),[e,n]=I.exports.useState([]),[b,d]=I.exports.useState([]),o=le(),[h]=oe(),[P]=ne(),l=ce(),{setHeader:g}=Z();I.exports.useEffect(()=>{g("users")},[]);const m=a=>o.openConfirmModal({title:t("delete"),children:t("deleteMessage"),labels:{confirm:t("confirm"),cancel:t("cancel")},withCloseButton:!1,confirmProps:{color:"red"},centered:!0,onCancel:()=>{},onConfirm:()=>{a&&h({variables:{where:{id:a}},refetchQueries:[M.Query.DashboardUsers]})}}),w=(a,y)=>{a&&P({variables:{data:{disabled:{set:!y}},where:{id:a}},refetchQueries:[M.Query.DashboardUsers]})};if(!s)return r($,{height:"80vh"});const T=()=>{const a=o.openModal({title:t("addStudent"),size:"xl",children:r(ue,{onSubmit:()=>{l.showNotification({message:t("success"),color:"green"}),o.closeModal(a)},onCancel:()=>{o.closeModal(a)}})})},F=a=>{const y=o.openModal({title:t("editStudent"),size:"xl",children:r(de,{student:s==null?void 0:s.students[a],onSubmit:()=>{l.showNotification({message:t("success"),color:"green"}),o.closeModal(y)},onCancel:()=>{o.closeModal(y)}})})},G=()=>p(E,{p:10,children:[r(N,{onClick:T,mb:8,children:t("add")}),r(L,{selectedIndexes:b,setSelectedIndexes:d,height:"80vh",headerModifier:t,data:s==null?void 0:s.students.map(a=>{var y;return{id:a.id,firstName:a.firstName,lastName:a.lastName,email:a.user.email,topic:(y=a.topic)==null?void 0:y.name,year:a.year,status:r(v,{color:a.user.disabled?"blue":"green",children:a.user.disabled?t("disabled"):t("enabled")})}}),actionsLabel:t("actions"),actions:a=>p(C,{children:[r(B,{onClick:()=>F(a),color:"green",variant:"light",children:r(A,{})}),p(S,{children:[r(S.Item,{onClick:()=>w(s==null?void 0:s.students[a].user.id,s==null?void 0:s.students[a].user.disabled),color:s!=null&&s.students[a].user.disabled?"green":"blue",children:s!=null&&s.students[a].user.disabled?t("enable"):t("disable")}),r(S.Item,{color:"red",onClick:()=>m(s==null?void 0:s.students[a].user.id),children:t("delete")})]})]})})]}),O=()=>{const a=o.openModal({title:t("addTeacher"),size:"xl",children:r(he,{onSubmit:()=>{l.showNotification({message:t("success"),color:"green"}),o.closeModal(a)},onCancel:()=>{o.closeModal(a)}})})},H=a=>{const y=o.openModal({title:t("addTeacher"),size:"xl",children:r(pe,{teacher:s==null?void 0:s.teachers[a],onSubmit:()=>{l.showNotification({message:t("success"),color:"green"}),o.closeModal(y)},onCancel:()=>{o.closeModal(y)}})})},J=()=>p(E,{m:10,children:[r(N,{mb:10,onClick:O,children:t("add")}),r(L,{selectedIndexes:e,setSelectedIndexes:n,headerModifier:t,height:"80vh",data:s==null?void 0:s.teachers.map(a=>({id:a.id,firstName:a.firstName,lastName:a.lastName,email:a.user.email,status:r(v,{color:a.user.disabled?"blue":"green",children:a.user.disabled?t("disabled"):t("enabled")})})),actionsLabel:t("actions"),actions:a=>p(C,{children:[r(B,{onClick:()=>H(a),color:"green",variant:"light",children:r(A,{})}),p(S,{children:[r(S.Item,{color:s!=null&&s.teachers[a].user.disabled?"green":"blue",onClick:()=>w(s==null?void 0:s.teachers[a].user.id,s==null?void 0:s.teachers[a].user.disabled),children:s!=null&&s.teachers[a].user.disabled?t("enable"):t("disable")}),r(S.Item,{color:"red",onClick:()=>m(s==null?void 0:s.teachers[a].user.id),children:t("delete")})]})]})})]});return r(me,{withBorder:!0,p:4,children:p(x,{children:[r(x.Tab,{label:t("students"),children:r(G,{})}),r(x.Tab,{label:t("teachers"),children:r(J,{})})]})})};export{we as DashboardUsers,we as default};
