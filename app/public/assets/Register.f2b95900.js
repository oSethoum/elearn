var C=Object.defineProperty;var w=Object.getOwnPropertySymbols;var L=Object.prototype.hasOwnProperty,F=Object.prototype.propertyIsEnumerable;var y=(i,e,a)=>e in i?C(i,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):i[e]=a,n=(i,e)=>{for(var a in e||(e={}))L.call(e,a)&&y(i,a,e[a]);if(w)for(var a of w(e))F.call(e,a)&&y(i,a,e[a]);return i};import{a8 as j,t as k,r as m,a3 as z,v as u,w as E,j as t,aD as A,d as l,F as Y,k as G,a5 as H,Y as O,m as R,a6 as d,S as V,h as g,aF as S,x as p,y as f,P as D,b8 as J,ay as M,E as K,b9 as v,z as Q}from"./vendor.0be45842.js";import{H as U}from"./Header.cb0b718c.js";import{C as W,F as X}from"./BrandLogos.fa73e98b.js";import{u as Z}from"./index.388e8e0a.js";import{L as _}from"./Logo.99ad6cec.js";import{B as $}from"./BackButton.4e6bd3ff.js";const ne=()=>{const i=j(),{t:e}=k(),{user:a}=Z(),[h,x]=m.exports.useState([]),N=z();function I(s){fetch("/api/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}).then(o=>{o.status===201&&(v({title:e("success"),message:e("registerSuccess"),color:"green"}),N("/")),o.status===400&&v({title:e("failed"),message:e("registerFailed"),color:"red"})}).catch(o=>{console.log(o)})}const P=u.object({firstName:u.string().min(4,e("minimumLength")+" 4"),lastName:u.string().min(4,e("minimumLength")+" 4"),username:u.string().min(6,e("minimumLength")+" 6"),email:u.string().min(8,e("minimumLength")+" 8"),password:u.string().min(6,e("minimumLength")+" 6")}),[b,B]=m.exports.useState([]);m.exports.useEffect(()=>{fetch("/api/topics").then(s=>s.json()).then(s=>{x(s.map(o=>({label:o.name,value:o.id.toString(),years:o.years,group:o.department.name})))}).catch(s=>console.log(s))},[]);const r=E({schema:Q(P),initialValues:{firstName:"",lastName:"",topic:"",year:"",username:"",role:"",email:"",password:""}});m.exports.useEffect(()=>{const s=h.find(c=>c.value===r.values.topic),o=[];if(s)for(let c=1;c<=s.years;c++)o.push(c.toString());B(o),r.values.year="1"},[r.values.topic]);const[T,q]=m.exports.useState(!1);return a?t(A,{to:"/404"}):l(Y,{children:[t(U,{leftSide:t($,{}),rightSide:t(W,{}),withBorder:!0,children:t(G,{align:"center",size:"xl",weight:"bolder",children:e("register")})}),t(H,{size:"xs",my:30,children:l(O,{p:20,shadow:"sm",withBorder:i.colorScheme==="dark",children:[t(R,{children:t(_,{width:350})}),t(d,{h:10}),l("form",{onSubmit:r.onSubmit(s=>{I(s)}),noValidate:!0,children:[l(V,{children:[l(g,{direction:"column",grow:!0,children:[t(S,{order:3,children:e("personalInformation")}),t(p,n({label:e("firstName"),placeholder:e("firstName"),required:!0},r.getInputProps("firstName"))),t(p,n({label:e("lastName"),placeholder:e("lastName"),required:!0},r.getInputProps("lastName"))),t(f,n({label:e("role"),placeholder:e("role"),required:!0,data:[{label:e("teacher"),value:"teacher"},{label:e("student"),value:"student"}]},r.getInputProps("role"))),h.length>0&&r.values.role==="student"&&t(f,n({label:e("topic"),placeholder:e("topic"),required:!0,data:h},r.getInputProps("topic"))),b.length>0&&r.values.role==="student"&&t(f,n({label:e("year"),placeholder:e("year"),required:!0,data:b},r.getInputProps("year")))]}),t(d,{h:10}),l(g,{direction:"column",grow:!0,children:[t(S,{order:3,children:e("loginInformation")}),t(p,n({label:e("username"),placeholder:e("username"),required:!0},r.getInputProps("username"))),t(p,n({label:e("email"),placeholder:e("email"),required:!0},r.getInputProps("email"))),t(D,n({label:e("password"),placeholder:e("password"),required:!0},r.getInputProps("password")))]})]}),t(d,{h:30}),T&&t(J,{onClose:()=>q(!1),title:e("error"),withCloseButton:!0,variant:"outline",color:"red",children:e("formError")}),t(d,{h:30}),l(g,{position:"apart",grow:!0,children:[t("div",{children:t(M,{style:{padding:5},to:"/login",children:e("login")})}),t(K,{type:"submit",style:{width:150},children:e("register")})]})]})]})}),t(X,{withBorder:!0})]})};export{ne as Register,ne as default};
