var B=Object.defineProperty,D=Object.defineProperties;var z=Object.getOwnPropertyDescriptors;var x=Object.getOwnPropertySymbols;var E=Object.prototype.hasOwnProperty,S=Object.prototype.propertyIsEnumerable;var I=(t,e,a)=>e in t?B(t,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[e]=a,m=(t,e)=>{for(var a in e||(e={}))E.call(e,a)&&I(t,a,e[a]);if(x)for(var a of x(e))S.call(e,a)&&I(t,a,e[a]);return t},u=(t,e)=>D(t,z(e));import{f as w,g as A,n as y,h as G,u as L,i as O}from"./schema.bcb88cc1.js";import{t as M,r as b,v as h,w as v,z as N,j as s,B as T,d as l,S as P,x as j,y as k,a2 as q,h as C,E as f,J as U,K as V,O as Q,Q as F,U as H}from"./vendor.0be45842.js";import{u as J,L as K}from"./index.388e8e0a.js";import{D as R}from"./DataGrid.9dd6d65b.js";const W=({onSubmit:t,onCancel:e,topic:a})=>{var g;const{t:n}=M(),i=b.exports.useMemo(()=>h.object({name:h.string()}),[]),{data:d}=w(),[c]=A(),r=v({schema:N(i),initialValues:{name:a.name,department:(g=a.department)==null?void 0:g.id.toString(),years:a.years}});return s(T,{children:l("form",{onSubmit:r.onSubmit(o=>{console.log(o),c({variables:{where:{id:a.id},data:{name:{set:o.name},years:{set:o.years},department:{connect:{id:parseInt(o.department)}}}},refetchQueries:[y.Query.Topics],onCompleted(){t==null||t()}})}),children:[l(P,{children:[s(j,u(m({label:n("name"),placeholder:n("name")},r.getInputProps("name")),{required:!0})),s(k,u(m({label:n("department"),data:(d==null?void 0:d.departments.map(o=>({label:o.name,value:o.id.toString()})))||[]},r.getInputProps("department")),{required:!0})),s(q,m({label:n("years")},r.getInputProps("years")))]}),l(C,{mt:20,position:"right",children:[s(f,{onClick:e,variant:"default",children:n("cancel")}),s(f,{type:"submit",color:"green",children:n("apply")})]})]})})},X=({onSubmit:t,onCancel:e})=>{const{t:a}=M(),n=b.exports.useMemo(()=>h.object({name:h.string(),years:h.number().positive("cannotBeNegative")}),[]),{data:i}=w(),[d]=G(),c=v({schema:N(n),initialValues:{name:"",department:"1",years:1}});return s(T,{children:l("form",{onSubmit:c.onSubmit(r=>d({variables:{data:{name:r.name,years:r.years,department:{connect:{id:parseInt(r.department)}}}},refetchQueries:[y.Query.Topics],onCompleted(){t==null||t()}})),children:[l(P,{children:[s(j,u(m({label:a("name"),placeholder:a("name")},c.getInputProps("name")),{required:!0})),s(k,m({label:a("department"),data:(i==null?void 0:i.departments.map(r=>({label:r.name,value:r.id.toString()})))||[],required:!0},c.getInputProps("department"))),s(q,u(m({label:a("years")},c.getInputProps("years")),{required:!0}))]}),l(C,{mt:20,position:"right",children:[s(f,{onClick:e,variant:"default",children:a("cancel")}),s(f,{type:"submit",children:a("add")})]})]})})},te=()=>{const{data:t}=L(),{t:e}=M(),[a]=O(),n=U(),i=V(),{setHeader:d}=J();if(b.exports.useEffect(()=>{d("topics")},[]),!t)return s(K,{height:"80vh"});const c=()=>{const o=n.openModal({title:e("addTopic"),size:"xl",children:s(X,{onCancel:()=>{n.closeModal(o)},onSubmit:()=>{n.closeModal(o),i.showNotification({message:e("success"),color:"green"})}})})},r=o=>{const p=n.openConfirmModal({title:e("confirmAction"),children:e("deleteMessage"),labels:{confirm:e("confirm"),cancel:e("cancel")},confirmProps:{color:"red"},centered:!0,withCloseButton:!1,onConfirm:()=>{a({variables:{where:{id:t.topics[o].id}},refetchQueries:[y.Query.Topics],onCompleted(){n.closeModal(p),i.showNotification({message:e("success"),color:"green"})}})}})},g=o=>{const p=n.openModal({title:e("editTopic"),size:"xl",children:s(W,{topic:t.topics[o],onSubmit:()=>{n.closeModal(p),i.showNotification({message:e("success"),color:"green"}),console.log(t.topics[o])},onCancel:()=>n.closeModal(p)})})};return l(T,{sx:{height:"100%"},m:10,children:[s(f,{onClick:c,mb:20,children:e("add")}),s(R,{headerModifier:e,data:t==null?void 0:t.topics.map(o=>{var p;return{id:o.id,name:o.name,department:(p=o.department)==null?void 0:p.name,years:o.years}}),actionsLabel:"actions",actions:o=>l(C,{children:[s(Q,{onClick:()=>g(o),color:"green",children:s(F,{})}),s(Q,{onClick:()=>r(o),color:"red",children:s(H,{})})]})})]})};export{te as Topics,te as default};
