var A=Object.defineProperty;var j=Object.getOwnPropertySymbols;var F=Object.prototype.hasOwnProperty,G=Object.prototype.propertyIsEnumerable;var v=(o,n,e)=>n in o?A(o,n,{enumerable:!0,configurable:!0,writable:!0,value:e}):o[n]=e,l=(o,n)=>{for(var e in n||(n={}))F.call(n,e)&&v(o,e,n[e]);if(j)for(var e of j(n))G.call(n,e)&&v(o,e,n[e]);return o};import{t as O,r as S,v as r,w as J,z as D,j as s,B as K,d as f,S as L,x,P as I,h as B,E as z,a8 as Q,a3 as R,J as V,K as W,a_ as M,O as _,a$ as $,b0 as q,k as H}from"./vendor.0be45842.js";import{u as U}from"./index.388e8e0a.js";const X=({onSubmit:o,onCancel:n})=>{var m,d,g,P,N,u;const{user:e,setUser:t}=U(),{t:a}=O(),b=(e==null?void 0:e.role)=="admin"?(m=e==null?void 0:e.admin)==null?void 0:m.firstName:(e==null?void 0:e.role)=="student"?(d=e==null?void 0:e.student)==null?void 0:d.firstName:(g=e==null?void 0:e.teacher)==null?void 0:g.firstName,w=(e==null?void 0:e.role)=="admin"?(P=e==null?void 0:e.admin)==null?void 0:P.lastName:(e==null?void 0:e.role)=="student"?(N=e==null?void 0:e.student)==null?void 0:N.lastName:(u=e==null?void 0:e.teacher)==null?void 0:u.firstName,C=S.exports.useMemo(()=>r.object({firstName:r.string().nonempty(a("notEmpty")),lastName:r.string().nonempty(a("notEmpty")),username:r.string().nonempty(a("notEmpty")),email:r.string().email(a("invalidEmail")).nonempty(a("notEmpty")),password:r.string(),newPassword:r.string(),confirmPassword:r.string()}).refine(c=>c.password===c.confirmPassword,{message:a("passwordsDontMatch"),path:["newPassword","confirmPassword"]}),[]),i=J({schema:D(C),initialValues:{firstName:b,lastName:w,username:e==null?void 0:e.username,email:e==null?void 0:e.email,password:"",newPassword:"",confirmPassword:""}});return s(K,{children:f("form",{onSubmit:i.onSubmit(c=>{fetch("/api/update-user",{method:"POST",body:JSON.stringify(l({id:e==null?void 0:e.id},c)),headers:{"Content-Type":"application/json"}}).then(p=>{p.status==200?(fetch("/api/refresh",{method:"POST"}).then(h=>{h.ok&&h.json().then(y=>{t(y)})}),o==null||o()):p.status==400&&i.setFieldError("password",a("wrongPassword"))})}),children:[f(L,{cols:1,breakpoints:[{minWidth:"md",cols:2}],children:[s(x,l({label:a("firstName"),placeholder:a("firstName")},i.getInputProps("firstName"))),s(x,l({label:a("lastName"),placeholder:a("lastName")},i.getInputProps("lastName"))),s(x,l({label:a("username"),placeholder:a("username")},i.getInputProps("username"))),s(x,l({label:a("email"),placeholder:a("email")},i.getInputProps("email"))),s(I,l({label:a("password"),placeholder:a("password")},i.getInputProps("password"))),s(I,l({label:a("newPassword"),placeholder:a("newPassword")},i.getInputProps("newPassword"))),s(I,l({label:a("confirmPassword"),placeholder:a("confirmPassword")},i.getInputProps("confirmPassword")))]}),f(B,{position:"right",mt:20,children:[s(z,{onClick:n,variant:"default",children:a("cancel")}),s(z,{type:"submit",color:"green",children:a("apply")})]})]})})};function ae(){var c,p,h,y,T,E;const{t:o}=O(),n=Q(),e=R(),{user:t,setUser:a}=U(),{openConfirmModal:b,closeModal:w,openModal:C}=V(),{showNotification:i}=W(),[m,d]=S.exports.useState(!1),g=((c=t==null?void 0:t.student)==null?void 0:c.firstName)||((p=t==null?void 0:t.admin)==null?void 0:p.firstName)||((h=t==null?void 0:t.teacher)==null?void 0:h.firstName),P=((y=t==null?void 0:t.student)==null?void 0:y.lastName)||((T=t==null?void 0:t.admin)==null?void 0:T.lastName)||((E=t==null?void 0:t.teacher)==null?void 0:E.lastName),N=()=>{d(!1),b({title:o("logout"),children:o("logoutMessage"),centered:!0,confirmProps:{color:"red"},labels:{confirm:o("confirm"),cancel:o("cancel")},withCloseButton:!1,onConfirm:async()=>{await fetch("/api/logout",{method:"POST"}),e("/"),a(null)}})},u=()=>{d(!1);const k=C({title:o("editProfile"),size:"xl",children:s(X,{onCancel:()=>w(k),onSubmit:()=>{w(k),i({message:o("success"),color:"green"})}})})};return f(M,{size:"xl",opened:m,control:s(_,{onClick:()=>t&&d(!m),sx:{width:"auto"},radius:"xl",size:"xl",children:f(B,{mx:8,direction:"row",spacing:"xs",children:[s($,{color:n.primaryColor,size:34,radius:50}),s(q,{smallerThan:"md",styles:{display:"none"},children:s(H,{color:n.primaryColor,weight:"bold",children:t?g+" "+P:o("anonymous")})})]})}),children:[s(M.Item,{onClick:u,color:"green",children:o("editProfile")}),s(M.Item,{onClick:N,color:"red",children:o("logout")})]})}export{ae as U};
